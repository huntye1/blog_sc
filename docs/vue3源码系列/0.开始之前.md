---
id: vue_doc0
title: 开始之前
sidebar_label: 开始之前
slug: /
---

## Vue3 带来的新东西

2020 年 9 月，Vue3 的正式版发布了。vue3 保留了大量 2.0 的 api，所以从 2.0 迁移到 3.0 几乎很轻松。简单的说说其亮点：

| 特性                               | 解析                                                 |
| ---------------------------------- | ---------------------------------------------------- |
| Performance                        | 性能上比 Vue2.0 块 1.3 ～ 2 倍                       |
| Tree shaking support               | 按需编译，编译后体积更小                             |
| Composition API                    | 参考 React Hook 设计的 API，相对来说逻辑更加容易复用 |
| Better TypeScript support          | 由于源码直接由 TS 写的，所以对 TS 有更好的支持       |
| Custom Renderer API                | 暴露了自定义渲染的 API                               |
| Fragment,Teleport(Protal),Suspense | 更多先进的特性                                       |



### 性能

* 重写了虚拟DOM的实现
* 编译模版优化（静态节点不会转为节点对象）
* 初始化组件更加高效
* 性能提高1.3～2倍
* SSR性能2～3倍



![image-20201010181225607](https://cdn.jsdelivr.net/gh/huntye1/gallery@master/image-20201010181225607.png)



[模版编译优化](https://vue-next-template-explorer.netlify.com/)：静态节点会被标记，不会在diff中比较以及重新渲染。



### Tree shaking

* HelloWorld例子大小减小到13.5kb
  * 使用composition API仅有11.75kb
* 包含所有运行态22.5kb
  * 比Vue2体积更小，功能更小

### Compisition API

* 兼容现在的options API（实际上就是提供setup选项）
* 逻辑更加复用
* Reactivity模块可以单独使用，搭配其他框架。

 ### Fragments，Teleport，Suspense

* Fragments不再限制单根节点，可以不用包一层了。
* Teleport跟React类似，组件层面保持原有位置，DOM渲染可以渲染到另外的地方。
* Supspense支持异步渲染，使用支持async setup()及Async Components。

### 更好的TypeScript 支持

* 源代码使用TS书写，自动生成类型定义（不用单独维护了）
* SFC 的templete中属性也支持类型校验了。
* 支持TSX

### 自定义渲染API

* 可以渲染在不同的平台上。（得益于Vue的功能分块，可以单独使用其中的一部分包）



## 阅读Vue3源码
### 为什么阅读源码？

> 如果说写代码是表达自己，那么阅读代码就是理解别人。理解别人犹如学习别人的思想，学习优秀的思想提高自己的思想能力，从而提高编程水平。

两个字：<b>学习</b>。

跳出自己的思维，学习别人的思想。

从内容上讲，学习设计模式，学习代码组织，学习数据结构，学习成熟的解决方案......

### 如何阅读源码？

参考：[如何阅读源码？](https://www.zhihu.com/question/19625320)

总结一下：

* 需要预先了解代码的背景，基本思想，基本方案.......即需要解决的问题和解决的方案。

* 主动思考
  * 如果自己会怎么写：正向推导 + 验证
  * 改写代码以及debug调试代码
* 整体把握，各个击破。理解整体的流程，忽略细节。重点理解重点部分的模块代码，各个击破。
* 理清思路输出。最好带有目的阅读，回答大脑的问题，输出答案，防止大脑觉得"懂了"。

### 开始阅读

首先去github fork一份vue3源码，fork一份的好处是随时自己修改代码或者添加一些注释。

#### 分析目录结构

![image-20201010210655403](https://cdn.jsdelivr.net/gh/huntye1/gallery@master/image-20201010210655403.png)

重点分析packages目录，可以看到这里面根据功能划分出了很多包。vue3使用的是[monorepo](https://en.wikipedia.org/wiki/Monorepo) 的能力把多个包管理在一个package目录下面。







